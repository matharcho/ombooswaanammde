local UI = {}

local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MHub"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

local minimized = false

local function ApplyBorder(obj)
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = 2
    stroke.Color = Color3.fromRGB(21, 132, 173)
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Parent = obj
end

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0.375, 0, 0.537, 0)
MainFrame.Position = UDim2.new(0.36, 0, 0.137, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(32, 32, 32)
MainFrame.BackgroundTransparency = 1
MainFrame.Parent = ScreenGui

local Glow = Instance.new("UIStroke")
Glow.Parent = MainFrame
Glow.Thickness = 4.7
Glow.Color = Color3.fromRGB(12, 118, 255)
Glow.Transparency = 0.59
Glow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

local UIAspectRatioConstraint = Instance.new("UIAspectRatioConstraint")
UIAspectRatioConstraint.Name = "UIAspectRatioConstraint"
UIAspectRatioConstraint.AspectRatio = 1.60976
UIAspectRatioConstraint.Parent = MainFrame

local Mainline = Instance.new("Frame")
Mainline.Name = "Mainline"
Mainline.Size = UDim2.new(1.004, 0, 0.011, 0)
Mainline.Position = UDim2.new(-0.0022, 0, 0.18214, 0)
Mainline.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Mainline.BorderColor3 = Color3.fromRGB(0, 0, 0)
Mainline.BackgroundTransparency = 0.4
Mainline.ZIndex = 5
Mainline.Parent = MainFrame

local UIGradient = Instance.new("UIGradient")
UIGradient.Name = "UIGradient"
UIGradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0.000, Color3.fromRGB(127, 172, 255)),ColorSequenceKeypoint.new(0.500, Color3.fromRGB(116, 255, 244)),ColorSequenceKeypoint.new(1.000, Color3.fromRGB(109, 173, 255))}
UIGradient.Transparency = NumberSequence.new{NumberSequenceKeypoint.new(0.000, 1),NumberSequenceKeypoint.new(0.400, 0),NumberSequenceKeypoint.new(0.510, 0),NumberSequenceKeypoint.new(0.600, 0),NumberSequenceKeypoint.new(1.000, 1)}
UIGradient.Parent = Mainline

local MiniIcon = Instance.new("ImageButton")
MiniIcon.Name = "MiniIcon"
MiniIcon.Parent = ScreenGui
MiniIcon.Size = UDim2.new(0.03761, 0, 0.10539, 0)
MiniIcon.Position = UDim2.new(0.1, 0, 0.207, 0)
MiniIcon.BackgroundTransparency = 1
MiniIcon.ScaleType = Enum.ScaleType.Crop
MiniIcon.BorderSizePixel = 0
MiniIcon.ImageTransparency = 0
MiniIcon.ImageColor3 = Color3.new(255, 255, 255)
MiniIcon.ZIndex = 7
MiniIcon.Image = "rbxassetid://5019337540"
MiniIcon.Visible = false
ApplyBorder(MiniIcon)

local UIAspectRatioConstraint1 = Instance.new("UIAspectRatioConstraint")
UIAspectRatioConstraint1.Name = "UIAspectRatioConstraint1"
UIAspectRatioConstraint1.AspectRatio = 1.1343
UIAspectRatioConstraint1.Parent = MiniIcon

local MiniCorner = Instance.new("UICorner")
MiniCorner.CornerRadius = UDim.new(0, 10)
MiniCorner.Parent = MiniIcon

local Shadow = Instance.new("ImageLabel")
Shadow.Name = "Shadow"
Shadow.Parent = MainFrame
Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
Shadow.Position = UDim2.new(0.4998, 0, 0.49991, 0)
Shadow.Size = UDim2.new(1.004, 0, 1.00632, 0)
Shadow.BackgroundTransparency = 1
Shadow.Image = "rbxassetid://17784624382"
Shadow.ImageColor3 = Color3.new(255, 255, 255)
Shadow.ImageTransparency = 0.16
Shadow.ScaleType = Enum.ScaleType.Stretch
Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(0.54, 0, 0.097, 0)
Title.Position = UDim2.new(0.216, 0, 0.082, 0)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.Fondamento
Title.TextColor3 = Color3.fromRGB(51, 175, 255)
Title.BorderColor3 = Color3.fromRGB(18, 18, 55)
Title.TextScaled = true
Title.TextWrapped = true
Title.Text = "MeeTsuo | AutoBounty"
Title.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = Title

local MinButton = Instance.new("ImageButton")
MinButton.Name = "MinimizeButton"
MinButton.Parent = MainFrame
MinButton.Size = UDim2.new(0.09568, 0, 0.13309, 0)
MinButton.Position = UDim2.new(0.8833, 0, 0.03836, 0)
MinButton.BackgroundTransparency = 1
MinButton.Image = "rbxassetid://73200981173057"
MinButton.ImageColor3 = Color3.fromRGB(255,255,255)

local MinButtonCorner = Instance.new("UICorner")
MinButtonCorner.CornerRadius = UDim.new(0, 6)
MinButtonCorner.Parent = MinButton

MinButton.MouseButton1Click:Connect(function()
    if minimized then return end
    minimized = true

    TweenService:Create(MainFrame, TweenInfo.new(0.25), {Size = UDim2.new(0,0,0,0), Position = UDim2.new(0,0,0,0)}):Play()

    task.delay(0.25, function()
        MainFrame.Visible = false
        MiniIcon.Visible = true
    end)
end)

MiniIcon.MouseButton1Click:Connect(function()
    if not minimized then return end
    minimized = false

    MiniIcon.Visible = false
    MainFrame.Visible = true

    TweenService:Create(MainFrame, TweenInfo.new(0.25), {
        Size = UDim2.new(0.375, 0, 0.537, 0),
        Position = UDim2.new(0.36, 0, 0.137, 0)
    }):Play()
end)

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinButton

local Message = Instance.new("TextLabel")
Message.Name = "Message"
Message.Parent = MainFrame
Message.Position = UDim2.new(0.80487, 0, 0.90351, 0)
Message.Size = UDim2.new(0.19624, 0, 0.096, 0)
Message.BackgroundTransparency = 1
Message.ZIndex = 8
Message.TextColor3 = Color3.fromRGB(137, 205, 255)
Message.Font = Enum.Font.Fondamento
Message.TextScaled = true
Message.TextWrapped = true
Message.Text = "By MeeTsuo"

local TargetStatusLabel = Instance.new("TextLabel")
TargetStatusLabel.Name = "TargetStatusLabel"
TargetStatusLabel.Parent = MainFrame
TargetStatusLabel.Position = UDim2.new(0.086, 0, 0.271, 0)
TargetStatusLabel.Size = UDim2.new(0.419, 0, 0.089, 0)
TargetStatusLabel.BackgroundTransparency = 1
TargetStatusLabel.TextColor3 = Color3.fromRGB(137, 205, 255)
TargetStatusLabel.TextScaled = true
TargetStatusLabel.TextWrapped = true
TargetStatusLabel.Font = Enum.Font.Fondamento
TargetStatusLabel.Text = "Targets: none"

local TC1 = Instance.new("UICorner")
TC1.CornerRadius = UDim.new(0, 10)
TC1.Parent = TargetStatusLabel
ApplyBorder(TargetStatusLabel)

function UI.UpdateTargetsList(list)
    if typeof(list) == "table" then
        local names = {}

        for _, v in ipairs(list) do
            if typeof(v) == "Instance" and v:IsA("Player") then
                table.insert(names, v.Name)
            else
                table.insert(names, tostring(v))
            end
        end

        TargetStatusLabel.Text = "" .. table.concat(names, ", ")
    else
        TargetStatusLabel.Text = "" .. tostring(list or "none")
    end
end

local CurrentTargetLabel = Instance.new("TextLabel")
CurrentTargetLabel.Name = "CurrentTargetLabel"
CurrentTargetLabel.Parent = MainFrame
CurrentTargetLabel.Position = UDim2.new(0.086, 0, 0.432, 0)
CurrentTargetLabel.Size = UDim2.new(0.419, 0, 0.089, 0)
CurrentTargetLabel.BackgroundTransparency = 1
CurrentTargetLabel.TextColor3 = Color3.fromRGB(137, 205, 255)
CurrentTargetLabel.Font = Enum.Font.Fondamento
CurrentTargetLabel.TextScaled = true
CurrentTargetLabel.TextWrapped = true
CurrentTargetLabel.Text = "Current Target: none"

local TC2 = Instance.new("UICorner")
TC2.CornerRadius = UDim.new(0, 10)
TC2.Parent = CurrentTargetLabel
ApplyBorder(CurrentTargetLabel)

function UI.SetTarget(name)
    CurrentTargetLabel.Text = "Current Target: " .. tostring(name or "none")
end

local NotifyColors = {
    success = Color3.fromRGB(60, 200, 90),
    error = Color3.fromRGB(220, 80, 80),
    warn = Color3.fromRGB(240, 180, 70),
    info = Color3.fromRGB(80, 170, 240),
}

local PermanentNote = Instance.new("TextLabel")
PermanentNote.Name = "PermanentNote"
PermanentNote.Parent = MainFrame
PermanentNote.Size = UDim2.new(0.418, 0, 0.089, 0)
PermanentNote.Position = UDim2.new(0.086, 0, 0.589, 0)
PermanentNote.TextColor3 = NotifyColors.info
PermanentNote.Font = Enum.Font.Fondamento
PermanentNote.TextScaled = true
PermanentNote.TextWrapped = true
PermanentNote.Text = "No News"
PermanentNote.BackgroundTransparency = 1
PermanentNote.TextTransparency = 0
ApplyBorder(PermanentNote)

local C = Instance.new("UICorner", PermanentNote)
C.CornerRadius = UDim.new(0, 10)

function UI.ShowNotification(text, nType)
    nType = nType or "info"

    if text == nil or text == "" then
        text = "No News"
    end

    PermanentNote.Text = text
    PermanentNote.TextColor3 = NotifyColors[nType]
end

local function createStatLabel(name, posY)
    local label = Instance.new("TextLabel")
    label.Name = name
    label.Parent = MainFrame
    label.Size = UDim2.new(0.331, 0, 0.079, 0)
    label.Position = UDim2.new(0.612, 0, posY, 0)
    label.BackgroundTransparency = 1
    label.BackgroundColor3 = Color3.fromRGB(52, 52, 52)
    label.TextColor3 = Color3.fromRGB(137, 205, 255)
    label.Font = Enum.Font.Fondamento
    label.TextScaled = true
    label.TextWrapped = true
    label.Text = name .. ": 0"
    ApplyBorder(label)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = label
    return label
end

local EarnedLabel = createStatLabel("Earned", 0.321)
local TotalLabel = createStatLabel("Total Earned", 0.432)
local BountyLabel = createStatLabel("Bounty/Honor", 0.539)

function UI.UpdateStats(Earned, TotalEarned, Bounty)
    EarnedLabel.Text = "Earned: " .. tostring(Earned)
    TotalLabel.Text = "Total Earned: " .. tostring(TotalEarned)
    BountyLabel.Text = "Bounty/Honor: " .. tostring(Bounty)
end

local SkipButton = Instance.new("TextButton")
SkipButton.Name = "SkipButton"
SkipButton.Parent = MainFrame
SkipButton.Size = UDim2.new(0.311, 0, 0.093, 0)
SkipButton.Position = UDim2.new(0.145, 0, 0.796, 0)
SkipButton.BackgroundTransparency = 1
SkipButton.TextColor3 = Color3.fromRGB(137, 205, 255)
SkipButton.Font = Enum.Font.Fondamento
SkipButton.TextScaled = true
SkipButton.TextWrapped = true
SkipButton.Text = "Skip Player"

ApplyBorder(SkipButton)
local SkipButtonCorner = Instance.new("UICorner")
SkipButtonCorner.CornerRadius = UDim.new(0, 10)
SkipButtonCorner.Parent = SkipButton

SkipButton.MouseButton1Click:Connect(function()
    if getgenv().SkipPlayer then
        getgenv().SkipPlayer()
        if getgenv().checked then
            UI.UpdateTargetsList(getgenv().checked)
        end
    end
end)

local SpectateButton = Instance.new("TextButton")
SpectateButton.Name = "SpectateButton"
SpectateButton.Parent = MainFrame
SpectateButton.Size = UDim2.new(0.311, 0, 0.093, 0)
SpectateButton.Position = UDim2.new(0.54, 0, 0.796, 0)
SpectateButton.BackgroundTransparency = 1
SpectateButton.TextColor3 = Color3.fromRGB(137, 205, 255)
SpectateButton.Font = Enum.Font.Fondamento
SpectateButton.TextScaled = true
SpectateButton.TextWrapped = true
SpectateButton.Text = "Spectate: OFF"
ApplyBorder(SpectateButton)

local SpectateCorner = Instance.new("UICorner")
SpectateCorner.CornerRadius = UDim.new(0, 10)
SpectateCorner.Parent = SpectateButton

SpectateButton.MouseButton1Click:Connect(function()
    getgenv().SpectateTarget = not getgenv().SpectateTarget

    if getgenv().SpectateTarget then
        SpectateButton.BackgroundColor3 = Color3.fromRGB(80, 200, 80)
        SpectateButton.Text = "Spectate: ON"

        if getgenv().targ and getgenv().targ.Character then
            workspace.CurrentCamera.CameraSubject = getgenv().targ.Character
        end

    else
        SpectateButton.BackgroundColor3 = Color3.fromRGB(200, 80, 80)
        SpectateButton.Text = "Spectate: OFF"

        local lp = game.Players.LocalPlayer
        if lp.Character and lp.Character:FindFirstChild("Humanoid") then
            workspace.CurrentCamera.CameraSubject = lp.Character.Humanoid
        end
    end
end)

local TranButton = Instance.new("TextButton")
TranButton.Name = "TranButton"
TranButton.Parent = MainFrame
TranButton.Size = UDim2.new(0.331, 0, 0.079, 0)
TranButton.Position = UDim2.new(0.612, 0, 0.649, 0)
TranButton.BackgroundTransparency = 1
TranButton.TextColor3 = Color3.fromRGB(137, 205, 255)
TranButton.Font = Enum.Font.Fondamento
TranButton.TextScaled = true
TranButton.TextWrapped = true
TranButton.Text = "TransformFruitSkills: OFF"
ApplyBorder(TranButton)

local TranCorner = Instance.new("UICorner")
TranCorner.CornerRadius = UDim.new(0, 10)
TranCorner.Parent = TranButton

TranButton.MouseButton1Click:Connect(function()
    getgenv().FruitTransform = not getgenv().FruitTransform

    if getgenv().FruitTransform then
        TranButton.BackgroundColor3 = Color3.fromRGB(80, 200, 80)
        TranButton.Text = "TransformFruitSkills: ON"

        if getgenv().targ and getgenv().targ.Character then
            workspace.CurrentCamera.CameraSubject = getgenv().targ.Character
        end

    else
        TranButton.BackgroundColor3 = Color3.fromRGB(200, 80, 80)
        TranButton.Text = "TransformFruitSkills: OFF"        
    end
end)

local dragging, dragStart, startPos = false, nil, nil

local function startDrag(input)
    dragging = true
    dragStart = input.Position
    startPos = MainFrame.Position
    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then
            dragging = false
        end
    end)
end

local function updateDrag(input)
    if dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        startDrag(input)
    end
end)

UIS.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement
    or input.UserInputType == Enum.UserInputType.Touch then
        updateDrag(input)
    end
end)

local draggingMini = false
local dragStartMini, startPosMini

MiniIcon.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingMini = true
        dragStartMini = input.Position
        startPosMini = MiniIcon.Position
    end
end)

UIS.InputChanged:Connect(function(input)
    if draggingMini and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStartMini
        MiniIcon.Position = UDim2.new(
            startPosMini.X.Scale,
            startPosMini.X.Offset + delta.X,
            startPosMini.Y.Scale,
            startPosMini.Y.Offset + delta.Y
        )
    end
end)

MiniIcon.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingMini = false
    end
end)

local SG = game:GetService("StarterGui")

local function Notify(msg)
    SG:SetCore("SendNotification", {
        Title = "Hello Guys Info!",
        Text = msg,
        Duration = 5
    })
end

task.wait(5)

Notify("Keysystem will reset in today at 7pm and old key will not work")

return UI
